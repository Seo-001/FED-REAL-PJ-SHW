<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>로그인</title>
    <link rel="stylesheet" href="./css/main.css" />
    <link rel="stylesheet" href="./css/sub.css" />

    <link rel="stylesheet" href="./css/media.css" />

    <!-- 스크립트 태그를 사용해서 axios 라이브러리 불러옵니다. -->

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="./JS/jquery-3.6.3.min.js"></script>
    <script src="./JS/jquery-ui.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-latest.min.js"></script> -->
    <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
    <script src="./JS/smoothScroll20.js"></script>

    <script>
      Kakao.init('5bc11e136d9aff8a86918035d140a193');
    </script>
     <script src="./JS/main.js"></script>
    <script>
      $(document).ready(function () {
        const code = location.search.split('?code=')[1];
        if (code !== undefined) {
          requestToken(code)
            .then(({ data }) => {
              console.log('requestToken:', data);
              document.querySelector("#token-result").innerHTML=
              `<h1>LOGIN SUCCESS</h1>
              <img src=./img/welcome.png>
              `;

              // document.write('login success');
            })
            .catch((err) => {
              console.error('requestToken:', err);
            });
        } //////////////

        function requestToken(code) {
          const JS_APP_KEY = '5bc11e136d9aff8a86918035d140a193';
          const REDIRECT_URI = 'http://127.0.0.1:5500/01_01.수정본_개인프로젝트_서해원/login.html';
          const makeFormData = (params) => {
            const searchParams = new URLSearchParams();
            Object.keys(params).forEach((key) => {
              searchParams.append(key, params[key]);
              console.log('key', key, params[key]);
            });
            console.log('search');
            /*  append
      search params에 key-value 쌍으로 항목을 추가합니다.

      params.append('tag', "js");
      params.toString(); // mode=night&page=2&mode=day&tag=js
      쿼리에 tag=js 라는 항목이 추가된 것을 확인할 수 있습니다. 만일 같은 key가 여러번 추가되면 append() 메소드는 쿼리에 항목을 여러번 추가합니다.

      params.append('tag', "tricks");
      params.toString(); // mode=night&page=2&mode=day&tag=js&tag=tricks */
            return searchParams;
          }; /////makeFormData/////////
          //  post axios를 사용하여 요청을 하는 값
          return axios({
            method: 'POST',
            headers: {
              'content-type': 'application/x-www-form-urlencoded;charset=utf-8',
            },
            url: 'https://kauth.kakao.com/oauth/token',
            data: makeFormData({
              grant_type: 'authorization_code',
              client_id: JS_APP_KEY,
              redirect_uri:REDIRECT_URI,
              code,
            }), ///////////
          }); //////axios///////
        } ///requesttoken/////////
      }); ///ready////////////
    </script>
  </head>
  <body>
   
  </body>
  <body>
    <div class="searchbx">
      <div id="top">
        <header class="top">
          <!-- 1-1 로고+ 1.2 sns 모음 덩어리 묶음 section -->
          <section class="tarea">
            <!-- 1-1. 올가니카 로고 왼쪽  -->
            <h1 class="logo">
              <a href="index.html">
                <img src="./img/logo.png" alt="로고" />
              </a>
            </h1>
            <!-- 1-2 , sns 모음 -->
            <aside class="tmenu">
              <ol class="sns">
                <li>
                  <a href="https://twitter.com/organica_foods" class="fa-brands fa-twitter" target="_blank">
                    <span class="ir">트위터 바로가기</span>
                  </a>
                </li>
                <li>
                  <a href="https://www.instagram.com/organicafood/" class="fa-brands fa-instagram" target="_blank">
                    <span class="ir">인스타 바로가기</span>
                  </a>
                </li>
                <li>
                  <a href="https://www.facebook.com/Organica/" class="fa-brands fa-facebook" target="_blank">
                    <span class="ir">페이스북 바로가기</span>
                  </a>
                </li>
                <li>
                  <a href="https://www.youtube.com/@organica958" class="fa-brands fa-youtube" target="_blank">
                    <span class="ir">유튜브 바로가기</span>
                  </a>
                </li>
                <li>
                  <a href="/01_01.수정본_개인프로젝트_서해원/map.html" class="fas fa-map-location" target="_blank">
                    <span class="ir">찾아오는 길</span>
                  </a>
                </li>
              </ol>
            </aside>
            <!-- 모바일에 사용   -->

            <button class="ham"></button>
          </section>
          <!-- 1-3 GNV 메뉴 -->
          <nav class="gnb">
            <!-- 움직이는 메뉴배경박스 -->
            <div class="mvbx"></div>
            <ul>
              <li>
                <a href="#pageabc">ABC</a>
              </li>
              <li>
                <a href="#pageyb">YUJA BANANA</a>
              </li>
              <li>
                <a href="#pagecom">COMPANY</a>
              </li>

              <li>
                <a href="#pagecont">CONTACT</a>
              </li>
            </ul>
          </nav>
        </header>
      </div>

      <div class="loginwrap">
<!--     
      <img src="./img/kakao.png" alt="카카오 로그인 버튼 " /> -->
      <p id="token-result"></p>
      
    </div>




    </div>
    <!-- 3. 하단영역  -->
       <!-- 3. 하단영역  -->
    <div class="info">
      <footer class="info">
        <!-- 3-1 회사정보 -->
        <div class="addr foot">
          <address>주소 : 서울특별시 용산구 이태원로55가길 40, 2층 (한남동)</address>
        </div>
        <!-- 3-2 회사번호 -->
        <div class="tel foot">고객센터: 1899-6332 운영시간 오전 9시 ~ 오후 6시 (점심시간: 낮 12시 ~ 1시)</div>
        <!-- 3-3 저작권 -->
        <div class="right foot">ⓒ ORGANICA CORP. ALL RIGHTS RESERVED</div>
      </footer>
    </div>
  </body>
</html>
